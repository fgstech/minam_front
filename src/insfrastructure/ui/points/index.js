import React, { useEffect, useState } from 'react';
import PointsAPI from '../../../api/points';
import AxiosService from "../../../lib/axios"
import "./style.css";

const Points = () => {
    const [points, setPoints] = useState("0");
    const format = (numero) => numero.toString().replace(/\B(?=(\d{3})+(?!\d))/g, '.');

    useEffect(async () => {
        try {
            const userId = AxiosService.getIdToken();
            const res = await PointsAPI.getWallet(userId);
            const { balance } = res.data.data;
            setPoints(format(balance));
        } catch (err) {
            setPoints(format(0));
        }

    }, [])

    return (
        <div className="points-container">
            <svg width="28" height="28" viewBox="0 0 42 42" fill="none" xmlns="http://www.w3.org/2000/svg">
                <g clip-path="url(#clip0_366_2)">
                    <path d="M21 0C9.42 0 0 9.42 0 21C0 32.58 9.42 42 21 42C32.58 42 42 32.58 42 21C42 9.42 32.58 0 21 0ZM21 38.84C11.16 38.84 3.16 30.84 3.16 21C3.16 11.16 11.16 3.16 21 3.16C30.84 3.16 38.84 11.16 38.84 21C38.84 30.84 30.84 38.84 21 38.84Z" fill="white" />
                    <path d="M31.5901 28.9989C30.9501 28.4089 29.9501 28.4589 29.3601 29.0989C27.1801 31.4789 24.0901 32.8389 20.8701 32.8389C18.1301 32.8389 15.4801 31.8589 13.4001 30.0889C12.7401 29.5189 11.7401 29.5989 11.1701 30.2589C10.6001 30.9189 10.6801 31.9189 11.3401 32.4889C13.9901 34.7489 17.3701 35.9989 20.8601 35.9989C24.9601 35.9989 28.9101 34.2589 31.6801 31.2289C32.2701 30.5889 32.2301 29.5889 31.5801 28.9989H31.5901Z" fill="white" />
                    <path d="M29.3693 24.5303H27.8693L27.9193 21.7703C27.9393 20.8603 27.9493 20.1303 27.9493 18.9903C27.9493 18.1603 27.8793 17.3803 27.7393 16.6703C27.3993 14.9303 26.4293 13.7503 24.8793 13.1603C24.0193 12.8403 23.0893 12.7203 22.1193 12.8103C20.6393 12.9403 19.4293 13.4503 18.4793 14.3303C18.4793 14.1203 18.4793 13.9103 18.4493 13.7003V13.6003C18.4193 13.3403 18.1993 13.1303 17.9293 13.1303H13.2893C13.0093 13.1303 12.7793 13.3603 12.7793 13.6403V15.5503C12.7793 15.8303 13.0093 16.0603 13.2893 16.0603H14.9993L14.8993 24.5403H13.6393C13.3593 24.5403 13.1293 24.7703 13.1293 25.0503V26.9503C13.1293 27.2303 13.3593 27.4603 13.6393 27.4603H19.8893C20.1693 27.4603 20.3993 27.2303 20.3993 26.9503V25.0403C20.3993 24.7603 20.1693 24.5303 19.8893 24.5303H18.3993L18.4193 23.3503C18.4293 22.3403 18.4493 21.7403 18.4693 20.9403L18.4893 19.9803C18.4993 19.4703 18.5493 19.0403 18.6293 18.6503C18.9093 17.3603 19.5093 16.5603 20.5293 16.1303C21.1293 15.8803 21.7893 15.8003 22.5593 15.9003C23.5193 16.0303 24.0593 16.5203 24.2693 17.4503C24.4093 18.1003 24.4893 18.7603 24.4893 19.3903C24.4893 20.4903 24.4793 21.1803 24.4593 22.0503L24.4093 24.5303H23.1493C22.8693 24.5303 22.6393 24.7603 22.6393 25.0403V26.9403C22.6393 27.2203 22.8693 27.4503 23.1493 27.4503H29.3793C29.6593 27.4503 29.8893 27.2203 29.8893 26.9403V25.0203C29.8893 24.7403 29.6593 24.5103 29.3793 24.5103L29.3693 24.5303Z" fill="white" />
                    <path d="M25.9796 7.89953C25.9596 7.73953 25.8696 7.59953 25.7396 7.49953L24.2896 6.47953C24.0396 6.30953 23.7096 6.33953 23.5096 6.56953L23.2496 6.86953C23.1296 6.99953 23.0196 7.12953 22.9096 7.24953C22.5096 7.64953 22.3696 7.66953 21.8796 7.40953C21.7596 7.33953 21.6396 7.27953 21.4996 7.19953C21.2596 7.06953 21.0196 6.92953 20.7696 6.80953C19.5096 6.20953 18.2996 6.10953 17.2596 6.50953C16.2796 6.88953 15.5296 7.67953 15.0396 8.86953L14.9996 8.95953C14.8796 9.23953 14.9996 9.56953 15.2696 9.70953L16.9196 10.5895C17.1896 10.7395 17.5296 10.6495 17.6996 10.3795L17.8496 10.1495L17.9896 9.91953C18.3996 9.29953 18.6896 9.22953 19.3296 9.60953L19.6296 9.78953C19.9196 9.95953 20.2196 10.1395 20.5496 10.2895C21.1596 10.5695 21.7696 10.7095 22.3496 10.7095C22.7496 10.7095 23.1396 10.6395 23.5096 10.5095C24.5096 10.1495 25.1196 9.36953 25.6496 8.67953L25.8796 8.37953C25.9796 8.24953 26.0196 8.08953 25.9996 7.92953L25.9796 7.89953Z" fill="white" />
                </g>
                <defs>
                    <clipPath id="clip0_366_2">
                        <rect width="42" height="42" fill="white" />
                    </clipPath>
                </defs>
            </svg>
            <span>{format(points)}</span>
        </div>
    );
};

export default Points;